var e=Object.defineProperty,i=Object.defineProperties,t=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(i,t,o)=>t in i?e(i,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[t]=o,l=(e,i)=>{for(var t in i||(i={}))r.call(i,t)&&s(e,t,i[t]);if(o)for(var t of o(i))a.call(i,t)&&s(e,t,i[t]);return e};import{m as c,o as n,c as d,F as h,s as v,a as p,t as u,r as m}from"./vendor.9fdfcb85.js";import{e as b}from"./index.d9c4f343.js";const g={name:"ColorResult",props:{colors:Array},data:()=>({}),computed:l({},c(["pickers"])),methods:{openColor(e){this.$router.push(`/hex/${e.value}`)}}},f={class:"video-wrapper--result"},C={class:"result-item--text"};g.render=function(e,i,t,o,r,a){return n(),d("div",f,[(n(!0),d(h,null,v(e.pickers,((e,i)=>(n(),d("div",{class:"video-wrapper--result-item",key:i},[p("div",{class:"result-item--color",style:`background-color: ${e.colorStyle}`,onClick:i=>a.openColor(e)},null,12,["onClick"]),p("div",C,u(e.colorText),1)])))),128))])};const w={name:"VideoPicker",inject:["notyf"],data:()=>({isInitialized:!1,color:"",interval:null,cameraDevices:[],isTorch:!1,isTorchAvailable:!1,isSwitchAvailable:!1}),async mounted(){this.$refs.canvas_ctx.width=436,this.$refs.canvas_ctx.height=414},computed:(y=l({},c(["contrast"])),k={hexColor(){return b("rgb",this.color).hex},controlCaptureClass(){return{active:this.isInitialized,inactive:!this.isInitialized}}},i(y,t(k))),methods:{async initializeCamera(e="environment"){const i=await navigator.mediaDevices.enumerateDevices(),t=i.find((e=>"videoinput"===e.kind&&e.label.indexOf("back")>0));this.cameraDevices=i.filter((e=>"videoinput"===e.kind)).slice(0,2);const o={audio:!1,video:!0};return t&&(this.isSwitchAvailable=i.length>1,o.video={facingMode:e}),navigator.mediaDevices.getUserMedia(o).then(this.handlerVideoSuccess).catch(this.handleVideoError)},onCaptureColor(){if(this.isInitialized){const e=this.hexColor;this.$store.dispatch("addPicker",{title:"HEX",type:"hex",value:e,colorText:`#${e}`,colorStyle:`#${e}`})}else this.initializeCamera().then((()=>{}))},onCapabilitiesReady(e){if("function"!=typeof e.getCapabilities)return!1;const i=e.getCapabilities(),t=e.getSettings();this.isTorchAvailable=!!i.torch,this.isTorch=!!t.torch},handlerVideoSuccess(e){const[i]=e.getVideoTracks(),t=this.$refs.video_ctx,o=this.$refs.canvas_ctx;window.stream=e,t.srcObject=e,t.addEventListener("loadedmetadata",(e=>{this.isInitialized=!0,setTimeout((()=>{this.onCapabilitiesReady(i)}),500)})),this.interval&&clearInterval(this.interval),this.interval=setInterval((()=>{const e=o.getContext("2d");e.drawImage(t,0,0,414,436);const i=e.getImageData(218,207,1,1).data.slice(0,3);this.color=i}),100)},handleVideoError(e){console.log("navigator.MediaDevices.getUserMedia error: ",e.message,e.name),"NotAllowedError"==e.name&&this.notyf.error("Camera Permission is DENIED. Plase enable it to make function normally."),this.isInitialized=!1,this.stopInterval()},onSwitchCamera(){const e=this.$refs.video_ctx.srcObject,[i]=e.getVideoTracks();if(this.isSwitchAvailable){const e="user"==i.getSettings().facingMode?"environment":"user";i.stop(),this.initializeCamera(e).catch((e=>{this.notyf.error("Error")}))}},onToggleTorch(){const e=this.$refs.video_ctx.srcObject,[i]=e.getVideoTracks();this.isTorchAvailable&&i.applyConstraints({advanced:[{torch:!this.isTorch}]}).then((()=>{const e=i.getSettings();this.isTorch=e.torch})).catch((e=>{this.notyf.error("Error while toggle torch/light")}))},stopInterval(){this.interval&&clearInterval(this.interval)}},beforeUnmount(){this.stopInterval()}};var y,k;const x={class:"video-wrapper"},T={class:"video-wrapper--view"},I={class:"video-wrapper--view-video",autoplay:"true",ref:"video_ctx"},S={class:"video-wrapper--view-canvas",ref:"canvas_ctx"},O={class:"color-indicator"},$={class:"color-indicator--label"},j={class:"color-indicator--label-text"},A=p("div",{class:"color-indicator--circle"},null,-1),P={class:"video-wrapper--control"};w.render=function(e,i,t,o,r,a){return n(),d("div",x,[p("div",T,[p("video",I,null,512),p("canvas",S,null,512),p("div",O,[p("div",$,[p("div",{class:"color-indicator--label-color",style:`background-color: #${a.hexColor}`},null,4),p("div",j,"#"+u(a.hexColor),1)]),A])]),p("div",P,[p("div",{class:["video-control--torch icon icon-tunder--white",{disabled:!r.isTorchAvailable}],disabled:!r.isTorchAvailable,onClick:i[1]||(i[1]=(...e)=>a.onToggleTorch&&a.onToggleTorch(...e))},null,10,["disabled"]),p("div",{class:["video-control--capture",a.controlCaptureClass],onClick:i[2]||(i[2]=(...e)=>a.onCaptureColor&&a.onCaptureColor(...e))},null,2),p("div",{class:["video-control--switch icon icon-switch--white",{disabled:!r.isSwitchAvailable}],disabled:!r.isSwitchAvailable,onClick:i[3]||(i[3]=(...e)=>a.onSwitchCamera&&a.onSwitchCamera(...e))},null,10,["disabled"])])])};const D={name:"ColorPicker",components:{ColorResult:g,VideoPicker:w}},E={id:"content",class:"color-picker--page"};D.render=function(e,i,t,o,r,a){const s=m("video-picker"),l=m("color-result");return n(),d("div",E,[p(s),p(l)])};export default D;
