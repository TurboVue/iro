var M=Object.defineProperty,S=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var b=(e,o,t)=>o in e?M(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,h=(e,o)=>{for(var t in o||(o={}))D.call(o,t)&&b(e,t,o[t]);if(C)for(var t of C(o))H.call(o,t)&&b(e,t,o[t]);return e},w=(e,o)=>S(e,L(o));import{u as k,m,a as E,b as $,_ as g,r as V,o as d,c as p,d as i,w as f,e as j,t as x,f as I,F,g as A,n as T,h as _,i as P,j as B,k as v,l as u,L as O,p as R}from"./index.c009188f.js";const N={name:"ColorResult",props:{colors:Array},setup(){const{t:e}=k();return{t:e}},computed:h(h({},m(E,["contrast"])),m($,["pickers"])),methods:{openColor(e){this.$router.push({name:"convert",params:{type:"hex",color:e.value}})}}},U={class:"video-color--result-label"},W={class:"heading"},G={class:"video-color--result-wrapper"},X={key:0,class:"video-color--result-empty bg-black-contrast"},q=["onClick"],J={class:"result-item--text"};function K(e,o,t,a,l,r){const n=V("t");return d(),p("div",{class:_(["video-color--result",`bg-${e.contrast}-contrast`])},[i("div",U,[f(i("span",W,null,512),[[n,"color_result.label_title"]]),j(" "+x(a.t("color_result.label_small"))+" : ",1)]),i("div",G,[e.pickers.length==0?(d(),p("div",X,[f(i("span",null,null,512),[[n,"color_result.empty"]])])):I("",!0),(d(!0),p(F,null,A(e.pickers,(s,c)=>(d(),p("div",{class:"video-color--result-item",key:c},[i("div",{class:"result-item--color",style:T(`background-color: ${s.colorStyle}`),onClick:xe=>r.openColor(s)},null,12,q),i("div",J,x(s.colorText),1)]))),128))])],2)}var Q=g(N,[["render",K]]);const Y={name:"IconCamera"},Z={width:"2em",height:"2em",viewBox:"0 0 24 24"},ee=i("path",{d:"M9.827 21.763L14.31 14l3.532 6.117A9.955 9.955 0 0 1 12 22c-.746 0-1.473-.082-2.173-.237zM7.89 21.12A10.028 10.028 0 0 1 2.458 15h8.965L7.89 21.119zM2.05 13a9.964 9.964 0 0 1 2.583-7.761L9.112 13H2.05zm4.109-9.117A9.955 9.955 0 0 1 12 2c.746 0 1.473.082 2.173.237L9.69 10L6.159 3.883zM16.11 2.88A10.028 10.028 0 0 1 21.542 9h-8.965l3.533-6.119zM21.95 11a9.964 9.964 0 0 1-2.583 7.761L14.888 11h7.064z",fill:"#313131"},null,-1),oe=[ee];function te(e,o,t,a,l,r){return d(),p("svg",Z,oe)}var ie=g(Y,[["render",te]]);const y=436,z=414,re={name:"VideoPicker",inject:["notyf"],components:{IconCamera:ie},data(){return{size:{width:y,height:z},isInitialized:!1,color:[33,33,33],interval:null,cameraDevices:[],isTorch:!1,isTorchAvailable:!1,isSwitchAvailable:!1}},setup(){const{t:e}=k();return{t:e}},mounted(){this.$refs.canvas_ctx.width=this.size.width,this.$refs.canvas_ctx.height=this.size.height},computed:w(h({},m(E,["contrast"])),{hexColor(){return P("rgb",this.color).hex},controlCaptureClass(){return{active:this.isInitialized,inactive:!this.isInitialized}}}),methods:w(h({},B($,["addPicker"])),{async initializeCamera(e){const o={audio:!1,video:{width:{ideal:1920,max:2560},height:{ideal:1080,max:1440}}};return e&&(o.video.facingMode=e),navigator.mediaDevices.getUserMedia(o).then(this.handlerVideoSuccess).catch(this.handleVideoError)},async setCameraDevices(){const e=await navigator.mediaDevices.enumerateDevices(),o=e.find(t=>t.kind==="videoinput"&&t.label.indexOf("back")>0);this.cameraDevices=e.filter(t=>t.kind==="videoinput").slice(0,2),o&&(this.isSwitchAvailable=e.length>1)},getVideoSize(){return this.$refs.video_ctx?{width:this.$refs.video_ctx.clientWidth,height:this.$refs.video_ctx.clientHeight}:{width:y,height:z}},onCaptureColor(){if(!this.isInitialized)this.initializeCamera().then(()=>this.setCameraDevices());else{const e=this.hexColor;this.addPicker({title:"HEX",type:"hex",value:e,colorText:`#${e}`,colorStyle:`#${e}`})}},onCapabilitiesReady(e){if(typeof e.getCapabilities!="function")return!1;const o=e.getCapabilities(),t=e.getSettings();this.isTorchAvailable=!!o.torch,this.isTorch=!!t.torch},handlerVideoSuccess(e){const[o]=e.getVideoTracks(),t=this.$refs.video_ctx,a=this.$refs.canvas_ctx;window.stream=e,t.srcObject=e,t.onloadedmetadata=()=>{this.isInitialized=!0,setTimeout(()=>{this.onCapabilitiesReady(o)},500)},this.interval&&clearInterval(this.interval),this.interval=setInterval(()=>{const l=a.getContext("2d");l.drawImage(t,0,0,this.size.width,this.size.height);const r=this.size.width/2,n=this.size.height/2,s=l.getImageData(r,n,1,1);this.color=s.data.slice(0,3)},100)},handleVideoError(e){console.error("navigator.MediaDevices.getUserMedia error: ",e.message,e.name),e.name==="NotAllowedError"&&this.notyf.error(this.t("notyf.camera_permission_denied")),this.isInitialized=!1,this.stopInterval()},onSwitchCamera(){const o=this.$refs.video_ctx.srcObject,[t]=o.getVideoTracks(),a=t.getSettings().facingMode==="user"?"environment":"user";t.stop(),this.initializeCamera(a).catch(l=>{this.notyf.error(this.t("notyf.error_general"))})},onToggleTorch(){const o=this.$refs.video_ctx.srcObject,[t]=o.getVideoTracks();t.applyConstraints({advanced:[{torch:!this.isTorch}]}).then(()=>{const a=t.getSettings();this.isTorch=a.torch}).catch(a=>{this.notyf.error(this.t("notyf.torch_error"))})},stopInterval(){this.interval&&clearInterval(this.interval)},stopVideoStream(){var e,o;if((o=(e=this.$refs)==null?void 0:e.video_ctx)!=null&&o.srcObject){const t=this.$refs.video_ctx.srcObject,[a]=t.getVideoTracks();a.stop(),this.$refs.video_ctx.srcObject=null}}}),activated(){const e=this.getVideoSize();e.width!==this.size.width&&(this.size=h({},e)),this.stopVideoStream(),this.color=[33,33,33],this.isInitialized=!1},deactivated(){this.stopVideoStream(),this.stopInterval()},beforeUnmount(){this.stopInterval()}},ae={class:"video-wrapper"},se={autoplay:"",playsinline:"",class:"video-wrapper--view-video",ref:"video_ctx"},ce={class:"video-wrapper--view-canvas",ref:"canvas_ctx"},le={class:"color-indicator"},ne={class:"color-indicator--label"},de={class:"color-indicator--label-text"},pe=i("div",{class:"color-indicator--circle"},null,-1),he={key:0,class:"helper-initialize"},ve={class:"video-wrapper--control"};function ue(e,o,t,a,l,r){const n=v("IconCamera"),s=V("t");return d(),p("div",ae,[i("div",{class:_(["video-wrapper--view",`bg-${e.contrast}-contrast`])},[i("video",se,null,512),i("canvas",ce,null,512),i("div",le,[i("div",ne,[i("div",{class:"color-indicator--label-color",style:T(`background-color: #${r.hexColor}`)},null,4),i("div",de,"#"+x(r.hexColor),1)]),pe]),l.isInitialized?I("",!0):(d(),p("div",he,[f(i("span",null,null,512),[[s,"camera.start_camera"]])]))],2),i("div",ve,[i("div",{class:"video-control--torch icon icon-tunder--white",onClick:o[0]||(o[0]=(...c)=>r.onToggleTorch&&r.onToggleTorch(...c))}),i("div",{class:_(["video-control--capture",r.controlCaptureClass]),onClick:o[1]||(o[1]=(...c)=>r.onCaptureColor&&r.onCaptureColor(...c))},[u(n)],2),i("div",{class:"video-control--switch icon icon-switch--white",onClick:o[2]||(o[2]=(...c)=>r.onSwitchCamera&&r.onSwitchCamera(...c))})])])}var ge=g(re,[["render",ue]]);const we={name:"ColorPicker",components:{VideoPicker:ge,ColorResult:Q,Lazy:O}},me={id:"content",class:"color-picker--page"};function fe(e,o,t,a,l,r){const n=v("VideoPicker"),s=v("ColorResult"),c=v("Lazy");return d(),p("div",me,[u(n),u(c,null,{default:R(()=>[u(s)]),_:1})])}var be=g(we,[["render",fe]]);export{be as default};
